@startuml

scale 1.2
hide footbox

!pragma teoz true

skinparam monochrome true
skinparam defaultFontName Source Sans Pro
skinparam sequenceMessageAlign center
skinparam participantBackgroundColor #white
skinparam noteBackgroundColor #white
skinparam sequenceGroupBackgroundColor #white
skinparam participantPadding 10

participant Publisher
participant Subscription
participant Subscriber

Subscriber -> Publisher : subscribe(Subscriber)
Publisher -> Subscription : new Subscription()
Publisher -> Subscriber : onSubscribe(Subscription)

loop until completed
    alt continuation
        Subscriber -> Subscription : request(long)
        Subscription -> Publisher
        Publisher -> Subscriber : onNext(T)
    else cancellation
        Subscriber -> Subscription : cancel()
        Subscription -> Publisher
    end
end

alt successful completion
    Publisher -> Subscriber : onComplete()
else erroneous completion
    Publisher -> Subscriber : onError(Throwable)
end

@enduml
